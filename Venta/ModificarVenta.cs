using System;using System.Collections.Generic;using System.ComponentModel;using System.Configuration;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Windows.Forms;using MySql.Data.MySqlClient;using MySql.Data;namespace Practica.Venta{    public partial class ModificarVenta : Form    {        String connString = "server=localhost; uid = root; port = 3308; database = tienda";        public void cargar_ID_VENTA()        {            MySqlConnection conn = new MySqlConnection(connString);            DataSet tabla = new DataSet();            string consulta = "SELECT ID_VENTA FROM venta";            try            {                MySqlDataAdapter interfaz = new MySqlDataAdapter(consulta, conn);                interfaz.Fill(tabla, "ID_VENTA");                ID_VENTA.ValueMember = "ID_VENTA";                ID_VENTA.DataSource = tabla.Tables[0];            }            catch (Exception e)            {                MessageBox.Show("Ha ocurrido un problema al cargar la lista de identificadores de proveedor.\n"                    + e.Message);            }        }        public ModificarVenta()        {            InitializeComponent();            cargar_ID_VENTA();            ID_VENTA.Text = "Escoge un valor de la lista";        }        private void Buscar_Click(object sender, EventArgs e)        {            if (ID_VENTA.Text == "Escoge un valor de la lista"){                MessageBox.Show("Debes escoger un valor de la lista antes de buscar.");                return;            }            MySqlConnection conn = new MySqlConnection(connString);            DataTable a = new DataTable();            string consulta = $"SELECT * FROM venta WHERE ID_VENTA = {ID_VENTA.SelectedValue}";            MySqlDataAdapter adapter = new MySqlDataAdapter(consulta, conn);            try {                adapter.Fill(a);                ID_CLIENTE.Text = a.Rows[0]["ID_CLIENTE"].ToString();                FECHA.Value = ((DateTime)a.Rows[0]["FECHA"]).Date;                HORA.Value = ((TimeSpan)a.Rows[0]["Hora"]).Hours;                MINUTO.Value = ((TimeSpan)a.Rows[0]["Hora"]).Minutes;                SEGUNDO.Value = ((TimeSpan)a.Rows[0]["Hora"]).Seconds;                TOTAL.Text = a.Rows[0]["TOTAL"].ToString();            }            catch(Exception ex){                MessageBox.Show($"Ha ocurrido un error al buscar el registro.\n{ex.Message}");            }        }        private void Actualizar_Click(object sender, EventArgs e)        {            if (ID_VENTA.Text == "Escoge un valor de la lista"){                MessageBox.Show("Debes escoger un valor de la lista antes de buscar.");                return;            }            MySqlConnection conexion;            conexion = new MySqlConnection(connString);            try            {                conexion.Open();                MySqlCommand comando = new MySqlCommand("UPDATE venta SET ID_CLIENTE = @ID_CLIENTE, FECHA = @FECHA, HORA = @HORA, TOTAL = @TOTAL WHERE ID_VENTA = @ID_VENTA", conexion);                comando.Parameters.Add("ID_VENTA", MySqlDbType.VarChar).Value = ID_VENTA.SelectedValue;                comando.Parameters.Add("ID_CLIENTE", MySqlDbType.VarChar).Value = ID_CLIENTE.Text;                comando.Parameters.Add("FECHA", MySqlDbType.Date).Value = FECHA.Value.Date;                comando.Parameters.Add("HORA", MySqlDbType.Time).Value = TimeOnly.Parse($"{HORA.Value.ToString()}:{MINUTO.Value.ToString()}:{SEGUNDO.Value.ToString()}");                comando.Parameters.Add("TOTAL", MySqlDbType.Int32).Value = TOTAL.Text;                comando.ExecuteNonQuery();                conexion.Close();                MessageBox.Show("Actualización exitosa");            }            catch (Exception ex) { MessageBox.Show("Ha ocurrido un error durante la actualización.\n" + ex.Message); }        }        public void limpiar()        {
            ID_VENTA.Text = "Escoge un valor de la lista";            ID_CLIENTE.Text = "";            FECHA.Value = DateTime.Now;            HORA.Value = 0;            MINUTO.Value = 0;            SEGUNDO.Value = 0;            TOTAL.Text = "";        }        private void Limpiar_Click(object sender, EventArgs e)        {            limpiar();        }        private void Eliminar_Click(object sender, EventArgs e)        {            MySqlConnection conn = new MySqlConnection(connString);            string consulta = $"delete from venta where ID_VENTA = {ID_VENTA.SelectedValue}";            MySqlCommand com = new MySqlCommand(consulta, conn);            try            {                conn.Open();                com.ExecuteNonQuery();                conn.Close();                cargar_ID_VENTA();                limpiar();                MessageBox.Show("Registro eliminado con éxito.");            }            catch (Exception ex)            {                MessageBox.Show($"Ha ocurrido un error al eliminar el registro.\n{ex.Message}");            }        }    }}